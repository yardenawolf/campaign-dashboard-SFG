<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SFG TEAM APP</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- MONTSERRAT FOR HEADER -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&display=swap" rel="stylesheet">
<link rel="manifest" href="manifest.json">

  <style>
    :root {
      /* BRAND */
      --navy: #003362;
      --gold: #FDBA18;

      /* UI */
      --bg: var(--navy);
      --card: #ffffff;
      --border: #e5e7eb;
    }

    * {
      box-sizing: border-box;
      text-transform: uppercase;
    }

    body {
      margin: 0;
      background: var(--bg);
      padding: 20px;
      font-family: Futura, "Trebuchet MS", Arial, sans-serif;
      color: var(--navy);
    }

    .app {
      max-width: 960px;
      margin: 0 auto;
    }

    /* HEADER */
    header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 28px;
      text-align: center;
    }

    header img {
      height: 180px;
      margin-bottom: 12px;
    }

    header h1 {
      font-family: "Montserrat", sans-serif;
      font-size: 56px;
      margin: 0;
      color: #ffffff;
      letter-spacing: 0.05em;
    }

    /* CONTROLS */
    .controls {
      margin-bottom: 16px;
    }

    select {
      width: 100%;
      padding: 14px;
      font-size: 14px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: #ffffff;
      color: var(--navy);
      font-family: Futura, "Trebuchet MS", Arial, sans-serif;
    }

    /* CARD */
    .card {
      background: var(--card);
      border-radius: 14px;
      padding: 24px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    }

    /* LINKS */
    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    li {
      margin: 14px 0;
    }

    a {
      color: var(--navy);
      font-weight: 600;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    /* FUNDRAISING TABLE */
    table {
      width: 100%;
      border-collapse: collapse;
    }

    td {
      padding: 14px 10px;
      border-bottom: 1px solid var(--border);
      font-size: 18px;
    }

    td:first-child {
      font-weight: 600;
    }

    footer {
      margin-top: 32px;
      font-size: 12px;
      color: #ffffff;
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="app">

    <header>
      <img src="assets/yellow-bear.png" alt="SFG Bear Logo Yellow">
      <h1>SFG TEAM APP</h1>
    </header>

    <div class="controls">
      <select id="sectionSelect">
        <option value="quickLinks">Quick Links</option>
        <option value="fundraising">Fundraising Summary</option>
        <option value="TeamInfo">Team Contact Information</option>
        <option value="wiringInfo">Donor Wire & Mail Information</option>
      </select>
    </div>

    <div id="content" class="card">
      Loading…
    </div>

    <footer>
      Internal use only. Paid for by Swalwell for Governor 2026.
    </footer>

  </div>

<script>
(function () {
  const PASSWORD = "SFG26!";

  // If already authenticated this session, allow
  if (sessionStorage.getItem("sfg_auth") === "true") return;

  const input = prompt("Enter password:");

  if (input === PASSWORD) {
    sessionStorage.setItem("sfg_auth", "true");
  } else {
    document.body.innerHTML = "";
    alert("Access denied.");
  }
})();
</script>
<script>
/* ---------- CSV PARSER (HANDLES COMMAS SAFELY) ---------- */
function parseCSV(text) {
  const rows = [];
  let row = [];
  let current = "";
  let insideQuotes = false;

  for (let char of text) {
    if (char === '"' ) {
      insideQuotes = !insideQuotes;
    } else if (char === "," && !insideQuotes) {
      row.push(current.trim());
      current = "";
    } else if (char === "\n" && !insideQuotes) {
      row.push(current.trim());
      rows.push(row);
      row = [];
      current = "";
    } else {
      current += char;
    }
  }
  if (current) row.push(current.trim());
  if (row.length) rows.push(row);
  return rows;
}

function formatMoney(val) {
  const num = Number(val.replace(/[^0-9.-]/g,""));
  return isNaN(num) ? val : "$" + num.toLocaleString();
}

const SECTIONS = {
  quickLinks: {
    url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1Z0IB-xXvYnIk7GnsqFOXdsFB8D7_WfIVMQhCiSmLg_6Ye9mCyTbi6YZgc7HMFIdhdCEAM0I9lcsJ/pub?gid=1066216552&single=true&output=csv",
    render: renderQuickLinks
  },
  fundraising: {
    url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1Z0IB-xXvYnIk7GnsqFOXdsFB8D7_WfIVMQhCiSmLg_6Ye9mCyTbi6YZgc7HMFIdhdCEAM0I9lcsJ/pub?gid=0&single=true&output=csv",
    render: renderFundraising
  },
  TeamInfo: {
    url: "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1Z0IB-xXvYnIk7GnsqFOXdsFB8D7_WfIVMQhCiSmLg_6Ye9mCyTbi6YZgc7HMFIdhdCEAM0I9lcsJ/pub?gid=1184013325&single=true&output=csv",
    render: renderTeamInfo
  },
  wiringInfo: {
    url: null,
    render: renderwiringInfo
  }
};

const content = document.getElementById("content");
const select = document.getElementById("sectionSelect");

select.addEventListener("change", () => loadSection(select.value));

function loadSection(key) {
  content.innerHTML = "Loading…";
  const section = SECTIONS [key];
  if (section.url) {
    fetch(section.url)
    .then(r => r.text())
    .then(text => parseCSV(text))
    .then(rows => section.render(rows))
    .catch(() => content.innerHTML = "Failed to load data.");
} else {
    section.render();
  }
}

function renderQuickLinks(rows) {
  const data = rows.slice(1);
  let html = "<ul>";
  data.forEach(([label, url]) => {
    if (label && url) {
      html += `<li><a href="${url}" target="_blank">${label}</a></li>`;
    }
  });
  html += "</ul>";
  content.innerHTML = html;
}

function renderFundraising(rows) {
  const data = rows.slice(1);
  let html = "<table>";
  data.forEach(([metric, value]) => {
    html += `<tr><td>${metric}</td><td>${formatMoney(value)}</td></tr>`;
  });
  html += "</table>";
  content.innerHTML = html;
}
  function renderTeamInfo(rows) {
  const data = rows.slice(1); // remove header row
  let html = "<table>";

  // Optional: Add a header row like fundraising uses
  html += `
    <tr>
      <td><strong>Name</strong></td>
      <td><strong>Email</strong></td>
      <td><strong>Phone</strong></td>
      <td><strong>Role</strong></td>
    </tr>
  `;

  data.forEach(row => {
    // Handles rows with missing columns safely
    const name      = row[0] || "";
    const email     = row[1] || "";
    const phone     = row[2] || "";
    const position  = row[3] || "";

    html += `
      <tr>
        <td>${name}</td>
        <td><a href="mailto:${email}">${email}</a></td>
        <td><a href="tel:${phone}">${phone}</a></td>
        <td>${position}</td>
      </tr>
    `;
  });

  html += "</table>";
  content.innerHTML = html;
}

function renderDonorWireMail() {
  const pdfUrl = "assets/wiring-info.pdf";
  content.innerHTML = `
    <div style="text-align: center; padding: 40px 20px;">
      <h2 style="margin-bottom: 24px; font-size: 24px;">Donor Wire & Mail Information</h2>
      <a href="${pdfUrl}" download style="
        display: inline-block;
        padding: 16px 32px;
        background: var(--gold);
        color: var(--navy);
        text-decoration: none;
        border-radius: 8px;
        font-weight: 700;
        font-size: 18px;
        transition: background 0.2s;
      " onmouseover="this.style.background='#f0a800'" onmouseout="this.style.background='var(--gold)'">
        Download PDF
      </a>
    </div>
  `;
}

loadSection("quickLinks");
</script>
  
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/service-worker.js");
}
</script>

</body>
</html>

